{
  "rules": {
    "_minimum_allowable_app_version": {
      ".read": "true",
      ".write": "false"
    },
    "admin": {
      ".read": "root.child('admin').hasChild(auth.uid)",
      ".write": "false"
    },
    "post": {
      ".indexOn": "slug",
      ".read": "true",
      "$post_id": {
        ".write": "!data.exists() || data.child('created_by').val() === auth.uid || root.child('admin').hasChild(auth.uid)",
        ".validate": "newData.hasChildren(['title','content','created_by','created_on'])",
        "title": { ".validate": "newData.isString() && newData.val() != ''" },
        "slug": { ".validate": "newData.isString() && newData.val() != ''" },
        "content": { ".validate": "newData.isString() && newData.val() != ''" },
        "metadata": {
          "created_by": { ".validate": "newData.isString() && newData.val() != ''" },
          "updated_by": { ".validate": "newData.isString() && newData.val() != ''" },
          "created_on": { ".validate": "newData.val().matches(/^20[0-9][0-9]-[0-9][0-9]-[0-9][0-9]T[0-9][0-9]:[0-9][0-9]:[0-9][0-9][+-][0-9][0-9]:[0-9][0-9]/)" },
          "updated_on": { ".validate": "newData.val().matches(/^20[0-9][0-9]-[0-9][0-9]-[0-9][0-9]T[0-9][0-9]:[0-9][0-9]:[0-9][0-9][+-][0-9][0-9]:[0-9][0-9]/)" },
          "$other": { ".validate": "false" }
        },
        "$other": { ".validate": "false" }
      }
    },
    "post_like": {
      ".read": "true",
      ".indexOn": "post",
      "$post_id": {
        ".write": "!data.exists() || data.child('created_by').val() === auth.uid || root.child('admin').hasChild(auth.uid)",
        ".validate": "newData.hasChildren(['post','created_by','created_on'])",
        "post": { ".validate": "newData.isString() && newData.val() != ''" },
        "metadata": {
          "created_by": { ".validate": "newData.isString() && newData.val() != ''" },
          "updated_by": { ".validate": "newData.isString() && newData.val() != ''" },
          "created_on": { ".validate": "newData.val().matches(/^20[0-9][0-9]-[0-9][0-9]-[0-9][0-9]T[0-9][0-9]:[0-9][0-9]:[0-9][0-9][+-][0-9][0-9]:[0-9][0-9]/)" },
          "updated_on": { ".validate": "newData.val().matches(/^20[0-9][0-9]-[0-9][0-9]-[0-9][0-9]T[0-9][0-9]:[0-9][0-9]:[0-9][0-9][+-][0-9][0-9]:[0-9][0-9]/)" },
          "$other": { ".validate": "false" }
        },
        "$other": { ".validate": "false" }
      }
    },
    "user": {
      "$user_id": {
        "account_preferences": {
          ".read": "$user_id === auth.uid",
          ".write": "$user_id === auth.uid",
          "YOUR ATTRIBUTE HERE": { ".validate": "newData.isString() && newData.val() != ''" },
          "$other": { ".validate": "false" }
        },
        "public_profile": {
          ".read": "true",
          ".write": "$user_id === auth.uid",
          "YOUR ATTRIBUTE HERE": { ".validate": "newData.isString() && newData.val() != ''" },
          "$other": { ".validate": "false" }
        },
        "metadata": {
          ".read": "$user_id === auth.uid",
          ".write": "$user_id === auth.uid",
          "created_by": { ".validate": "newData.isString() && newData.val() != ''" },
          "updated_by": { ".validate": "newData.isString() && newData.val() != ''" },
          "created_on": { ".validate": "newData.val().matches(/^20[0-9][0-9]-[0-9][0-9]-[0-9][0-9]T[0-9][0-9]:[0-9][0-9]:[0-9][0-9][+-][0-9][0-9]:[0-9][0-9]/)" },
          "updated_on": { ".validate": "newData.val().matches(/^20[0-9][0-9]-[0-9][0-9]-[0-9][0-9]T[0-9][0-9]:[0-9][0-9]:[0-9][0-9][+-][0-9][0-9]:[0-9][0-9]/)" },
          "last_login": { ".validate": "newData.val().matches(/^20[0-9][0-9]-[0-9][0-9]-[0-9][0-9]T[0-9][0-9]:[0-9][0-9]:[0-9][0-9][+-][0-9][0-9]:[0-9][0-9]/)" },
          "$other": { ".validate": "false" }
        },
        "$other": { ".validate": "false" }
      }
    },
    "$other": { ".validate": "false" }
  }
}
